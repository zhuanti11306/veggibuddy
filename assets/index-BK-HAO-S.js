import{g as bt,s as mt,a as ht,b as wt,u as kt,m as X,c as qt,d as Z,e as xt,r as It,l as St,f as rt,h as Dt}from"./index-DfbJhxeW.js";import{e as Pt,r as Lt,u as Ut,q as At,S as Et,d as W,p as K,a as ct,f as I,s as o,c as l,g as t,b as h,h as p,t as E,i as q,j as $,k as w,l as N,m as C,n as Gt,o as Mt,v as tt,w as Bt,x as zt,y as et,z as at,A as st,B as nt,C as Ft}from"./index-CiVeqNK5.js";import{s as vt,o as Ot}from"./GLTFLoader-CQaeW04e.js";function lt(n,e){return n===e||n?.[Et]===e}function G(n={},e,a,c){return Pt(()=>{var r,i;return Lt(()=>{r=i,i=[],Ut(()=>{n!==a(...i)&&(e(n,...i),r&&lt(a(...r),n)&&e(null,...r))})}),()=>{At(()=>{i&&lt(a(...i),n)&&e(null,...i)})}}),n}async function Tt(n,e){try{await ht(),e.dialog.close()}catch(a){console.error("Google 登入失敗：",a)}}var Vt=(n,e)=>e(1),jt=(n,e)=>e(2),Ct=I('<div class="dialog svelte-o27yn2"><div class="stages svelte-o27yn2"><div class="stage-container svelte-o27yn2"><form class="stage svelte-o27yn2"><h1 class="svelte-o27yn2">註冊或登入</h1> <label class="input-slot svelte-o27yn2"><span class="svelte-o27yn2">電子郵件</span> <input type="email" name="email" class="input svelte-o27yn2" placeholder="請輸入使用者帳戶電子郵件" autocomplete="email" required/></label> <div class="spacer svelte-o27yn2"></div> <button type="submit" class="button primary svelte-o27yn2">下一步</button> <button type="button" class="button secondary svelte-o27yn2">取消</button> <hr class="divider svelte-o27yn2"/> <button type="button" class="button secondary svelte-o27yn2"><img alt="Google Icon" class="svelte-o27yn2"/> 使用 Google 登入</button></form> <form class="stage svelte-o27yn2"><h1 class="svelte-o27yn2">帳戶密碼</h1> <label class="input-slot svelte-o27yn2"><span class="svelte-o27yn2">密碼</span> <input type="password" name="password" class="input svelte-o27yn2" placeholder="請輸入使用者密碼" autocomplete="new-password" required/></label> <div class="spacer svelte-o27yn2"></div> <p class="error-text svelte-o27yn2"> </p> <p class="loading-text svelte-o27yn2"> </p> <button type="submit" class="button primary svelte-o27yn2">下一步</button> <button type="button" class="button secondary svelte-o27yn2">上一步</button></form></div></div></div>');function Wt(n,e){K(e,!0);let a=h(null),c=h(null),r=h(void 0),i=h(void 0),f=ct({email:"",password:""});function y(u){if(u.preventDefault(),!t(a))return;const A=new FormData(t(a));!(f.email=A.get("email"))||!t(c)||(t(c).reset(),t(c).scrollIntoView({behavior:"smooth"}))}async function v(u){if(u.preventDefault(),!t(c))return;const A=new FormData(t(c));if(f.password=A.get("password"))try{p(r,"載入中……"),p(i,void 0),await mt(f.email,f.password),e.closeDialog()}catch{p(i,"登入失敗，請檢查您的電子郵件和密碼是否正確。")}finally{p(r,void 0)}}function _(u){switch(u){case 1:e.dialog.close();break;case 2:t(a)?.scrollIntoView({behavior:"smooth"});break}}var g=Ct(),k=l(g),S=l(k),b=l(S),D=o(l(b),8);D.__click=[Vt,_];var M=o(D,4);M.__click=[Tt,e];var B=l(M);G(b,u=>p(a,u),()=>t(a));var P=o(b,2),x=o(l(P),6),z=l(x),L=o(x,2),U=l(L),O=o(L,4);O.__click=[jt,_],G(P,u=>p(c,u),()=>t(c)),E(u=>{vt(B,"src",u),q(z,t(i)),q(U,t(r))},[()=>bt("googleIcon").src]),$("submit",b,y),$("submit",P,v),w(n,g),N()}W(["click"]);function Kt(n,e){const a=n.target;p(e,a.value,!0)}function Nt(n,e,a){const c=n.target;if(!t(e))return;const r=t(e).get(c.value);p(a,r?{name:r.name,type:r.typeId}:null,!0)}var Rt=I("<option> </option>"),Yt=(n,e)=>e(1),Ht=(n,e)=>e(2),Jt=I('<div class="dialog svelte-1q9yfp0"><div class="stages svelte-1q9yfp0"><div class="stage-container svelte-1q9yfp0"><div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">事前準備</h1> <p>在我們開始之前，告訴我你的名字吧！不需要告訴我你的真實姓名，而是給讓我知道我應該怎麼稱呼你。</p> <label class="input-slot svelte-1q9yfp0"><span class="svelte-1q9yfp0">暱稱</span> <input class="input svelte-1q9yfp0" name="nickname" type="text" placeholder="請輸入您的暱稱" autocomplete="nickname"/></label> <div class="spacer svelte-1q9yfp0"></div> <button class="button primary svelte-1q9yfp0">下一步</button></div> <div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">選擇寵物</h1> <p>選擇一隻與你合拍的小夥伴吧！在之後的每一天，你們將會一起交流、一起成長。</p> <div class="input-slot svelte-1q9yfp0"><span class="svelte-1q9yfp0">寵物</span> <select class="input svelte-1q9yfp0" name="pet"><option disabled selected>請選擇您的寵物</option><!></select></div> <div class="spacer svelte-1q9yfp0"></div> <div class="description svelte-1q9yfp0"><!></div> <button class="button primary svelte-1q9yfp0">下一步</button> <button class="button secondary svelte-1q9yfp0">上一步</button></div> <div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">最終確認</h1> <p>最後，讓我們確認一下。<strong> </strong>，我將會如此稱呼你，而你選擇的<strong> </strong>將會是你的夥伴。<br/> 沒有問題的話，我們就可以出發啦。</p> <div class="spacer svelte-1q9yfp0"></div> <button class="button primary svelte-1q9yfp0">完成</button> <button class="button secondary svelte-1q9yfp0">返回</button></div></div></div></div>');function Qt(n,e){K(e,!0);let a=ct([]),c=h(!1),r=h(""),i=h(null),f=h(null);Ot(()=>{let s=!1;return wt().then(d=>{if(s)return;const m=new Map;if(d)for(const F of d)m.set(F.typeId,F);p(f,m,!0)}),()=>s=!0});async function y(){p(c,!0),await kt(t(r),t(i).type),e.dialog.close()}function v(s){return d=>{d.currentTarget.disabled||s()}}function _(s){a[s-1]?.scrollIntoView({behavior:"smooth"})}var g=Jt(),k=l(g),S=l(k),b=l(S),D=o(l(b),4),M=o(l(D),2);M.__input=[Kt,r];var B=o(D,4),P=C(()=>v(()=>_(2)));B.__click=function(...s){t(P)?.apply(this,s)},G(b,s=>a[0]=s,()=>a?.[0]);var x=o(b,2),z=o(l(x),4),L=o(l(z),2);L.__input=[Nt,f,i];var U=l(L);U.value=U.__value="";var O=o(U);Gt(O,17,()=>t(f)?t(f).values():[],s=>s.typeId,(s,d)=>{var m=Rt(),F=l(m),Q={};E(()=>{q(F,t(d).name),Q!==(Q=t(d).typeId)&&(m.value=(m.__value=t(d).typeId)??"")}),w(s,m)});var u=o(z,4),A=l(u);{var T=s=>{var d=tt();E(m=>q(d,m),[()=>t(f).get(t(i).type)?.description]),w(s,d)},R=s=>{var d=tt("請選擇您的寵物");w(s,d)};Mt(A,s=>{t(i)&&t(f)?s(T):s(R,!1)})}var V=o(u,2),ut=C(()=>v(()=>_(3)));V.__click=function(...s){t(ut)?.apply(this,s)};var dt=o(V,2);dt.__click=[Yt,_],G(x,s=>a[1]=s,()=>a?.[1]);var Y=o(x,2),H=o(l(Y),2),J=o(l(H)),pt=l(J),ft=o(J,2),yt=l(ft),j=o(H,4),_t=C(()=>v(y));j.__click=function(...s){t(_t)?.apply(this,s)};var gt=o(j,2);gt.__click=[Ht,_],G(Y,s=>a[2]=s,()=>a?.[2]),E(()=>{B.disabled=!t(r),V.disabled=!t(i),q(pt,t(r)),q(yt,t(i)?.name),j.disabled=t(c)||!t(r)||!t(i)}),w(n,g),N()}W(["input","click"]);async function Xt(n,e,a){!t(e)&&(n.key==="Enter"||n.key===" ")&&await a()}var Zt=I('<div class="main svelte-17toa27" role="button" tabindex="-1"><img class="brand svelte-17toa27" alt="菜菜小伙伴"/> <p class="hint svelte-17toa27"> </p></div>'),$t=I('<p class="loading-text svelte-17toa27">載入中...</p>'),te=I('<div class="loading svelte-17toa27"><p>此應用仍在開發中，<br/> 功能可能不完整或有錯誤<br/> 歡迎隨時回報問題！:D<br/></p> <!></div>');function le(n,e){K(e,!0);let a=h(void 0);async function c(){p(a,"正在載入使用者資料……"),await xt()||await nt(Qt,{closeByOverlay:!1,closeByKeyboard:!1}),p(a,"正在載入遊戲資料……"),await Promise.all([It(),St()])}async function r(){if(t(a))return;let y=Z();y instanceof Promise&&(p(a,"正在檢查登入狀態..."),y=await Z(),p(a,void 0)),y===null&&await nt(Wt),y!==null&&(await c(),Ft("/game"))}var i=Bt(),f=zt(i);et(f,()=>it,y=>{var v=te(),_=o(l(v),2);et(_,()=>it.assetLoading,g=>{var k=$t();at(3,k,()=>st),w(g,k)}),at(3,v,()=>st),w(y,v)},y=>{var v=Zt();v.__click=r,v.__keydown=[Xt,a,r];let _;var g=l(v),k=o(g,2),S=l(k);E(b=>{_=qt(v,"",_,b),vt(g,"src",X.title.src),q(S,t(a)??"點擊任意位置開始")},[()=>({"background-image":`url(${X.mainScreen.src})`})]),w(y,v)}),w(n,i),N()}W(["click","keydown"]);const ot=Promise.all([Dt(),rt(1500)]),ee=rt(3e3),it=Object.assign(Promise.all([ot,ee]),{assetLoading:ot});export{le as default,it as showingLoadingScreen};
