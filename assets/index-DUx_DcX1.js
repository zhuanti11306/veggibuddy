import{g as gt,s as bt,a as mt,b as ht,u as wt,m as Y,c as Z,d as kt,r as qt,l as xt,e as it,f as It}from"./settings.svelte-B_7LO6Lk.js";import{d as H,p as K,n as rt,h as I,C as l,l as n,E,j as t,r as h,v as p,A,F as ct,B as q,e as $,b as w,g as N,G as St,w as W,a as Dt,u as Pt,z as tt,c as Ut,f as Gt,x as et,H as Lt,t as at,m as st}from"./vendor-BEoA47yD.js";import{g as Et}from"./index-CWAwd2vy.js";import{o as nt}from"./dialogs-DZWjIJ8s.js";import"./firebase-LKE9M92C.js";async function At(o,s){try{await mt(),s.dialog.close()}catch(e){console.error("Google 登入失敗：",e)}}var Ft=(o,s)=>s(1),Mt=(o,s)=>s(2),zt=I('<div class="dialog svelte-o27yn2"><div class="stages svelte-o27yn2"><div class="stage-container svelte-o27yn2"><form class="stage svelte-o27yn2"><h1 class="svelte-o27yn2">註冊或登入</h1> <label class="input-slot svelte-o27yn2"><span class="svelte-o27yn2">電子郵件</span> <input type="email" name="email" class="input svelte-o27yn2" placeholder="請輸入使用者帳戶電子郵件" autocomplete="email" required/></label> <div class="spacer svelte-o27yn2"></div> <button type="submit" class="button primary svelte-o27yn2">下一步</button> <button type="button" class="button secondary svelte-o27yn2">取消</button> <hr class="divider svelte-o27yn2"/> <button type="button" class="button secondary svelte-o27yn2"><img alt="Google Icon" class="svelte-o27yn2"/> 使用 Google 登入</button></form> <form class="stage svelte-o27yn2"><h1 class="svelte-o27yn2">帳戶密碼</h1> <label class="input-slot svelte-o27yn2"><span class="svelte-o27yn2">密碼</span> <input type="password" name="password" class="input svelte-o27yn2" placeholder="請輸入使用者密碼" autocomplete="new-password" required/></label> <div class="spacer svelte-o27yn2"></div> <p class="error-text svelte-o27yn2"> </p> <p class="loading-text svelte-o27yn2"> </p> <button type="submit" class="button primary svelte-o27yn2">下一步</button> <button type="button" class="button secondary svelte-o27yn2">上一步</button></form></div></div></div>');function Bt(o,s){K(s,!0);let e=h(null),c=h(null),i=h(void 0),v=h(void 0),y=rt({email:"",password:""});function f(d){if(d.preventDefault(),!t(e))return;const L=new FormData(t(e));!(y.email=L.get("email"))||!t(c)||(t(c).reset(),t(c).scrollIntoView({behavior:"smooth"}))}async function r(d){if(d.preventDefault(),!t(c))return;const L=new FormData(t(c));if(y.password=L.get("password"))try{p(i,"載入中……"),p(v,void 0),await bt(y.email,y.password),s.closeDialog()}catch{p(v,"登入失敗，請檢查您的電子郵件和密碼是否正確。")}finally{p(i,void 0)}}function _(d){switch(d){case 1:s.dialog.close();break;case 2:t(e)?.scrollIntoView({behavior:"smooth"});break}}var g=zt(),k=n(g),S=n(k),b=n(S),D=l(n(b),8);D.__click=[Ft,_];var F=l(D,4);F.__click=[At,s];var M=n(F);E(b,d=>p(e,d),()=>t(e));var P=l(b,2),x=l(n(P),6),z=n(x),U=l(x,2),G=n(U),V=l(U,4);V.__click=[Mt,_],E(P,d=>p(c,d),()=>t(c)),A(d=>{ct(M,"src",d),q(z,t(v)),q(G,t(i))},[()=>gt("googleIcon").src]),$("submit",b,f),$("submit",P,r),w(o,g),N()}H(["click"]);function Vt(o,s){const e=o.target;p(s,e.value,!0)}function jt(o,s,e){const c=o.target;if(!t(s))return;const i=t(s).get(c.value);p(e,i?{name:i.name,type:i.typeId}:null,!0)}var Ct=I("<option> </option>"),Ot=(o,s)=>s(1),Wt=(o,s)=>s(2),Ht=I('<div class="dialog svelte-1q9yfp0"><div class="stages svelte-1q9yfp0"><div class="stage-container svelte-1q9yfp0"><div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">事前準備</h1> <p>在我們開始之前，告訴我你的名字吧！不需要告訴我你的真實姓名，而是給讓我知道我應該怎麼稱呼你。</p> <label class="input-slot svelte-1q9yfp0"><span class="svelte-1q9yfp0">暱稱</span> <input class="input svelte-1q9yfp0" name="nickname" type="text" placeholder="請輸入您的暱稱" autocomplete="nickname"/></label> <div class="spacer svelte-1q9yfp0"></div> <button class="button primary svelte-1q9yfp0">下一步</button></div> <div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">選擇寵物</h1> <p>選擇一隻與你合拍的小夥伴吧！在之後的每一天，你們將會一起交流、一起成長。</p> <div class="input-slot svelte-1q9yfp0"><span class="svelte-1q9yfp0">寵物</span> <select class="input svelte-1q9yfp0" name="pet"><option disabled selected>請選擇您的寵物</option><!></select></div> <div class="spacer svelte-1q9yfp0"></div> <div class="description svelte-1q9yfp0"><!></div> <button class="button primary svelte-1q9yfp0">下一步</button> <button class="button secondary svelte-1q9yfp0">上一步</button></div> <div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">最終確認</h1> <p>最後，讓我們確認一下。<strong> </strong>，我將會如此稱呼你，而你選擇的<strong> </strong>將會是你的夥伴。<br/> 沒有問題的話，我們就可以出發啦。</p> <div class="spacer svelte-1q9yfp0"></div> <button class="button primary svelte-1q9yfp0">完成</button> <button class="button secondary svelte-1q9yfp0">返回</button></div></div></div></div>');function Kt(o,s){K(s,!0);let e=rt([]),c=h(!1),i=h(""),v=h(null),y=h(null);St(()=>{let a=!1;return ht().then(u=>{if(a)return;const m=new Map;if(u)for(const B of u)m.set(B.typeId,B);p(y,m,!0)}),()=>a=!0});async function f(){p(c,!0),await wt(t(i),t(v).type),s.dialog.close()}function r(a){return u=>{u.currentTarget.disabled||a()}}function _(a){e[a-1]?.scrollIntoView({behavior:"smooth"})}var g=Ht(),k=n(g),S=n(k),b=n(S),D=l(n(b),4),F=l(n(D),2);F.__input=[Vt,i];var M=l(D,4),P=W(()=>r(()=>_(2)));M.__click=function(...a){t(P)?.apply(this,a)},E(b,a=>e[0]=a,()=>e?.[0]);var x=l(b,2),z=l(n(x),4),U=l(n(z),2);U.__input=[jt,y,v];var G=n(U);G.value=G.__value="";var V=l(G);Dt(V,17,()=>t(y)?t(y).values():[],a=>a.typeId,(a,u)=>{var m=Ct(),B=n(m),X={};A(()=>{q(B,t(u).name),X!==(X=t(u).typeId)&&(m.value=(m.__value=t(u).typeId)??"")}),w(a,m)});var d=l(z,4),L=n(d);{var j=a=>{var u=tt();A(m=>q(u,m),[()=>t(y).get(t(v).type)?.description]),w(a,u)},R=a=>{var u=tt("請選擇您的寵物");w(a,u)};Pt(L,a=>{t(v)&&t(y)?a(j):a(R,!1)})}var C=l(d,2),vt=W(()=>r(()=>_(3)));C.__click=function(...a){t(vt)?.apply(this,a)};var dt=l(C,2);dt.__click=[Ot,_],E(x,a=>e[1]=a,()=>e?.[1]);var T=l(x,2),J=l(n(T),2),Q=l(n(J)),ut=n(Q),pt=l(Q,2),yt=n(pt),O=l(J,4),ft=W(()=>r(f));O.__click=function(...a){t(ft)?.apply(this,a)};var _t=l(O,2);_t.__click=[Wt,_],E(T,a=>e[2]=a,()=>e?.[2]),A(()=>{M.disabled=!t(i),C.disabled=!t(v),q(ut,t(i)),q(yt,t(v)?.name),O.disabled=t(c)||!t(i)||!t(v)}),w(o,g),N()}H(["input","click"]);async function Nt(o,s,e){!t(s)&&(o.key==="Enter"||o.key===" ")&&await e()}var Rt=I('<div class="main svelte-17toa27" role="button" tabindex="-1"><img class="brand svelte-17toa27" alt="菜菜小伙伴"/> <p class="hint svelte-17toa27"> </p></div>'),Tt=I('<p class="loading-text svelte-17toa27">載入中...</p>'),Jt=I('<div class="loading svelte-17toa27"><p>此應用仍在開發中，<br/> 功能可能不完整或有錯誤<br/> 歡迎隨時回報問題！:D<br/></p> <!></div>');function ee(o,s){K(s,!0);let e=h(void 0);async function c(){p(e,"正在載入使用者資料……"),await kt()||await nt(Kt,{closeByOverlay:!1,closeByKeyboard:!1}),p(e,"正在載入遊戲資料……"),await Promise.all([qt(),xt()])}async function i(){if(t(e))return;let f=Z();f instanceof Promise&&(p(e,"正在檢查登入狀態..."),f=await Z(),p(e,void 0)),f===null&&await nt(Bt),f!==null&&(await c(),Et("/game"))}var v=Ut(),y=Gt(v);et(y,()=>ot,f=>{var r=Jt(),_=l(n(r),2);et(_,()=>ot.assetLoading,g=>{var k=Tt();at(3,k,()=>st),w(g,k)}),at(3,r,()=>st),w(f,r)},f=>{var r=Rt();r.__click=i,r.__keydown=[Nt,e,i];let _;var g=n(r),k=l(g,2),S=n(k);A(b=>{_=Lt(r,"",_,b),ct(g,"src",Y.title.src),q(S,t(e)??"點擊任意位置開始")},[()=>({"background-image":`url(${Y.mainScreen.src})`})]),w(f,r)}),w(o,v),N()}H(["click","keydown"]);const lt=Promise.all([It(),it(1500)]),Qt=it(3e3),ot=Object.assign(Promise.all([lt,Qt]),{assetLoading:lt});export{ee as default,ot as showingLoadingScreen};
