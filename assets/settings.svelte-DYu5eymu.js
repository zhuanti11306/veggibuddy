import{a5 as gt,a2 as Ze,a6 as mt,a7 as wt,a8 as ke,V as O,R as Oe,T as yt,a9 as vt,aa as Pt,ab as Et,n as j,G as It,M as St,j as de,w as bt,Z as E,p as Rt,h as D,C as N,l as je,u as F,I as Tt,O as Mt,b as L,g as Lt,A as z,H as x,t as V,m as H,c as Ct,f as _t,J as xt,F as kt,ac as Ot,ad as De,ae as k,af as X,ag as jt,ah as he,ai as Be,aj as Ge,ak as Ne,al as Fe,am as ze,an as Dt,ao as Bt,ap as Gt,aq as Nt,ar as Ft,as as zt,at as Vt,au as Ht,av as Qt,aw as Ut,ax as Yt}from"./vendor-BEoA47yD.js";import{g as qt,i as Wt,a as Jt,o as Kt,s as Xt,c as Zt,b as $t,G as es,d as ts}from"./firebase-LKE9M92C.js";const $e="/assets/general-food-JVb2KwZL.png",ss="/assets/premium-food-CdpWG-sk.png",as="/assets/coins-4Gfj5xul.png",ns="/assets/translator-aSfpJSU4.png",et="/assets/camera-DNLcMxDO.png",tt="/assets/ball-CgvyNSCu.png",os="/assets/backpack-dMSZhBly.png",rs="/assets/shop-BU89ynGN.png",is="/assets/settings-Cpuyj8Kw.png",cs="/assets/chat-Cr63U3j9.png",us="/assets/back-DM3Hlk8H.png",As="/assets/back-to-game-C3tOQOU4.png",ls="/assets/reset-Bnrp9Ijb.png",ds="/assets/move-C4UBIf4a.png",hs="/assets/title-42LB1eXD.png",ps="/assets/main-screen-CqZc3HXN.png",fs="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='48px'%20height='48px'%3e%3cpath%20fill='%23fbc02d'%20d='M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12%20s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20%20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z'/%3e%3cpath%20fill='%23e53935'%20d='M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039%20l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z'/%3e%3cpath%20fill='%234caf50'%20d='M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36%20c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z'/%3e%3cpath%20fill='%231565c0'%20d='M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571%20c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z'/%3e%3c/svg%3e",gs="/assets/hand-sdmLSJ2D.png",ms="/assets/room-Bq_lHzDa.glb",ws="/assets/floor-DQ_5ENRy.glb",ys="/assets/sky01-w21dNtHV.hdr",vs="/assets/sky02-DcJivgSR.hdr",Ps="/assets/carrot-m5qgg4dg.glb",Es="/assets/nature_01-IXjBwEK3.ogg",Is="/assets/nature_02-Dz3MiWdE.ogg",Ss="/assets/happy_01-CcydxCPi.ogg",bs="/assets/confused_01-Y7BOeySg.ogg",Rs="/assets/confused_02-D06xR4Jo.ogg",Ts="/assets/sad_01-BYhDkJBw.ogg",Ms="/assets/carrot_face_01-CHquUTGf.png",Ls="/assets/carrot_face_02-C-1aTaUn.png",Cs="/assets/carrot_face_03-Cac803j7.png",_s="/assets/carrot_face_04-CfzrAWim.png",xs="data:image/png;base64,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",ks="/assets/carrot_face_06-C_okjAL-.png",Os="/assets/carrot_face_07-BaHPRRZ_.png",js="/assets/carrot_face_08-CwnIl9tm.png",Ds="/assets/carrot_face_09-1REgR4-v.png",Bs="/assets/carrot_face_10-Cb9lTvPg.png",Gs="/assets/carrot_face_11-jzwakdTp.png",Ns="/assets/carrot_face_12-SoM6wdLs.png",Fs="/assets/carrot_face_13-BpNOk7OM.png",zs="/assets/carrot_face_14-DZEU66vA.png";var Z=(e=>(e.nature="nature",e.happy="happy",e.confused="confused",e.sad="sad",e))(Z||{}),C=(e=>(e.neutral="Neutral",e.angry="Anger",e.happy="Happiness",e.scared="Fear",e.surprised="Surprise",e.sad="Sadness",e.disgusted="Disgust",e))(C||{});async function Pe(e,t=.125){if(!A.isLegal)return;const s=ae[A.type].sounds,a=e?s[e]:Object.values(s).flat();return!a||a.length===0?void 0:(ee+=t,a[Math.floor(Math.random()*a.length)].playSound())}async function Ee(e){if(!A.isLegal)return;const s=ae[A.type].faces[e];if(!s||s.length===0)return;const a=s[Math.floor(Math.random()*s.length)];!a||!a.texture||ae[A.type].model.changeMaterialMap("face",a.texture)}let $=null,ee=0;function Ya(){$||($=setInterval(()=>{const e=Math.random()+ee;if(ee-=.0625,e>.125)return;ee+=.5;const t=Math.random();t<.5?(Ee("Neutral"),t<.125&&Pe("nature")):(Ee("Happiness"),t<.625&&Pe("happy"))},334))}function qa(){$&&(clearInterval($),$=null)}function Vs(){ee+=.25,Ee("Happiness"),Math.random()<.5&&Pe("happy"),At("PET"),navigator.vibrate?.(100)}const Hs={model:Ps,icon:"",sounds:{[Z.nature]:[Es,Is],[Z.happy]:[Ss],[Z.confused]:[bs,Rs],[Z.sad]:[Ts]},faces:{[C.neutral]:[Ms,Ls],[C.angry]:[Cs,_s],[C.happy]:[xs,ks],[C.scared]:[Os,js],[C.surprised]:[Ds,Bs],[C.sad]:[Gs,Ns],[C.disgusted]:[Fs,zs]}},Qs="/assets/model-DgrKnggA.glb",Us="/assets/nature_01-IXjBwEK3.ogg",Ys="/assets/nature_02-Dz3MiWdE.ogg",qs="/assets/happy_01-CcydxCPi.ogg",Ws="/assets/confused_01-Y7BOeySg.ogg",Js="/assets/confused_02-D06xR4Jo.ogg",Ks="/assets/sad_01-BYhDkJBw.ogg";class Xs{url;asset;get texture(){return this.asset}whenLoaded;actionQueue=[];startLoad;rejectLoad;constructor(t){this.url=t;const{promise:s,resolve:a,reject:n}=Promise.withResolvers();this.whenLoaded=s.then(()=>new gt().loadAsync(this.url)).then(o=>this.asset=o).then(()=>this.clearActionQueue()),this.startLoad=a,this.rejectLoad=n}clearActionQueue(){return this.actionQueue.forEach(t=>t()),this.actionQueue.length=0,this}enqueueAction(t){return this.actionQueue.push(t),this}async load(){this.startLoad?.(),this.startLoad=void 0,this.rejectLoad=void 0,await this.whenLoaded}toggleFlipY(t){return this.texture?(this.texture.flipY=t??!this.texture.flipY,this.texture.needsUpdate=!0,this):this.enqueueAction(()=>this.toggleFlipY(t))}setTextureColorSpace(t){return this.texture?(this.texture.colorSpace=t==="srgb"?Ze:mt,this.texture.needsUpdate=!0,this):this.enqueueAction(()=>this.setTextureColorSpace(t))}}class Ie{url;gltf;get object(){return this.gltf?.scene}get animations(){return this.gltf?.animations}whenLoaded;actionQueue=[];startLoad;rejectLoad;constructor(t){this.url=t;const{promise:s,resolve:a,reject:n}=Promise.withResolvers();this.whenLoaded=s.then(()=>new wt().loadAsync(this.url)).then(o=>this.gltf=o).then(()=>this.clearActionQueue()),this.startLoad=a,this.rejectLoad=n}clearActionQueue(){return this.actionQueue.forEach(t=>t()),this.actionQueue.length=0,this}enqueueAction(t){return this.actionQueue.push(t),this}async load(){this.startLoad?.(),this.startLoad=void 0,this.rejectLoad=void 0,await this.whenLoaded}scaleIntoBox(t=1){if(!this.object)return this.enqueueAction(()=>this.scaleIntoBox(t));typeof t=="number"&&(t={x:t,y:t,z:t});const a=new ke().setFromObject(this.object).getSize(new O),n=Math.min((t.x??1/0)/a.x,(t.y??1/0)/a.y,(t.z??1/0)/a.z);return n!==1/0&&this.object.scale.setScalar(n),this}centerAtOrigin(){if(!this.object)return this.enqueueAction(()=>this.centerAtOrigin());const s=new ke().setFromObject(this.object).getCenter(new O);return this.object.position.sub(s),this}move(t,s=!0){if(!this.object)return this.enqueueAction(()=>this.move(t,s));const a=s?-1:1;return this.object.position.add(new O(t.x??0,t.y??0,(t.z??0)*a)),this}setOrigin(t){return this.object?(this.object.position.set(t.x,t.y,t.z),this):this.enqueueAction(()=>this.setOrigin(t))}rotate(t,s,a="origin"){if(!this.object)return this.enqueueAction(()=>this.rotate(t,s,a));let n=null;switch(a!=="origin"&&(n=new O(a.x,a.y,a.z)),n&&this.object.position.sub(n),s){case"x":this.object.rotateX(t);break;case"y":this.object.rotateY(t);break;case"z":this.object.rotateZ(t);break;default:this.object.rotateOnAxis(new O(s.x??0,s.y??0,s.z??0).normalize(),t)}return n&&this.object.position.add(n),this}applyShadown(t=!0,s=!0){return this.object?(this.object.traverse(a=>{a instanceof Oe&&(a.castShadow=t,a.receiveShadow=s)}),this):this.enqueueAction(()=>this.applyShadown(t,s))}changeMaterialMap(t,s){return this.object?(this.object.traverse(a=>{if(a instanceof Oe&&a.material instanceof yt){const n=a.material;n.name===t&&(n.map=s,n.needsUpdate=!0)}}),this):this.enqueueAction(()=>this.changeMaterialMap(t,s))}}class ge{url;texture;get envMap(){return this.texture}whenLoaded;actionQueue=[];startLoad;rejectLoad;constructor(t,s="hdr"){this.url=t;const{promise:a,resolve:n,reject:o}=Promise.withResolvers();this.whenLoaded=a.then(()=>ge.load(this.url,s)).then(r=>(r.mapping=vt,this.texture=r,this)),this.startLoad=n,this.rejectLoad=o}async load(){this.startLoad?.(),this.startLoad=void 0,this.rejectLoad=void 0,await this.whenLoaded}static load(t,s){let a;switch(s){case"hdr":a=new Et;break;case"exr":a=new Pt;break}return a.loadAsync(t)}}const st={API:{TSL:!0,get PROTOCOL(){return this.TSL?"https":"http"},get WS_PROTOCOL(){return this.TSL?"wss":"ws"},HOST:"cards-responding-eleven-buzz.trycloudflare.com",get BASE_URL(){return`${this.PROTOCOL}://${this.HOST}`},get WS_BASE_URL(){return`${this.WS_PROTOCOL}://${this.HOST}`}},FIREBASE:{apiKey:"AIzaSyAB5pLZ_zZVA6a3TNDip5kTiGoARAKIRyk",authDomain:"veggibuddy-db.firebaseapp.com",projectId:"veggibuddy-db",storageBucket:"veggibuddy-db.firebasestorage.app",messagingSenderId:"604849657161",appId:"1:604849657161:web:5d98aabf189abd4cedf698",measurementId:"G-03L2VK6RQG"}};var Se=(e=>(e.mushroom="pet01",e.carrot="pet02",e))(Se||{}),R=(e=>(e.generalFood="generalFood",e.premiumFood="premiumFood",e.coin="coin",e.translator="translator",e.veggieCam="veggieCam",e.ball="ball",e))(R||{});const v={THREE:{FIELD_OF_VIEW:60,NEAR_CLIPPING_PLANE:.0625,FAR_CLIPPING_PLANE:1024},INTERACT:{LONG_PRESS_DURATION:1200,LONG_PRESS_TROLERANCE:8*window.devicePixelRatio,PET_PROGRESS_STEP_THRESHOLD:50,PET_PROGRESS_BASIC_MAX:20,PET_PROGRESS_MAX_DECAY_INTERVAL:3e3}},Ve={FOOD_GROWTH_VALUES:{generalFood:20,premiumFood:50},PET_LEVEL_REQUIREMENTS:[120,280,500,900,1500]};var b=(e=>(e.defaultRoom="defaultRoom",e.throwingBallGame="throwingGame",e.hideNSeekGame="hideNSeekGame",e))(b||{});function h(e){return{src:e,complete:!1,async decode(){await this.getImage().decode(),this.complete=!0},getImage(){const t=new Image;return t.src=e,t}}}function Zs(e){return{src:e,complete:!1,async load(){await this.getAudio().load(),this.complete=!0},getAudio(){const t=new Audio;return t.src=e,t},async playSound(){if(Ha.sound===!1)return;const t=this.getAudio();return t.currentTime=0,new Promise(s=>{t.addEventListener("ended",()=>s(),{once:!0}),t.play()})}}}function He({model:e,sounds:t,faces:s,icon:a}){const n={};for(const[r,i]of Object.entries(t))n[r]=i.map(c=>Zs(c));const o={};for(const[r,i]of Object.entries(s))o[r]=i.map(c=>new Xs(c).toggleFlipY(!1).setTextureColorSpace("srgb"));return{model:new Ie(e).scaleIntoBox({x:.1,z:.1}).applyShadown(),sounds:n,faces:o,icon:h(a),async load(){await Promise.all([this.model.load(),this.loadSounds(),this.loadFaces()])},async loadModel(){await this.model.load()},async loadSounds(){const r=[];for(const i of Object.values(this.sounds))for(const c of i)r.push(c.load());await Promise.all(r)},async loadFaces(){const r=[];for(const i of Object.values(this.faces))for(const c of i)r.push(c.load());await Promise.all(r)}}}const at={title:h(hs),mainScreen:h(ps),googleIcon:h(fs)},nt={[R.generalFood]:h($e),[R.premiumFood]:h(ss),[R.coin]:h(as),[R.translator]:h(ns),[R.veggieCam]:h(et),[R.ball]:h(tt)},ot={inventory:h(os),shop:h(rs),feed:h($e),settings:h(is),chat:h(cs),back:h(us),backToGame:h(As),hand:h(gs),ball:h(tt),camera:h(et),reset:h(ls),move:h(ds)},$s={[b.defaultRoom]:{models:{room:new Ie(ms).applyShadown(!0)},environment:new ge(ys,"hdr")},[b.throwingBallGame]:{models:{field:new Ie(ws).applyShadown(!0).scaleIntoBox({x:20,z:20}).move({y:-.025})},environment:new ge(vs,"hdr")},[b.hideNSeekGame]:{models:{}}},ae={[Se.carrot]:He(Hs),[Se.mushroom]:He({model:Qs,icon:"",sounds:{normal:[Us,Ys],happy:[qs],confused:[Ws,Js],sad:[Ks]},faces:{}})};async function Wa(){const e=Object.values(ot).filter(t=>!t.complete).map(t=>t.decode());await Promise.all(e)}async function Te(e){await rt(e.map(t=>nt[t]).filter(Boolean))}async function Qe(e){const t=$s[e],s=[];for(const a of Object.values(t.models))s.push(a.load());return t.environment&&s.push(t.environment.load()),await Promise.all(s),t}async function ea(e){const t=ae[e];return await t.load(),t}async function Ja(){await rt(Object.values(at))}function Ka(e){return nt[e]}function ta(e){return ot[e]}function Xa(e){return at[e]}async function rt(e){const t=e.filter(s=>!s.complete).map(s=>s.decode());await Promise.all(t)}const sa=st.FIREBASE,aa=qt()[0]??Wt(sa),J=Jt(aa),te=Object.assign(new Promise(e=>{Kt(J,t=>{te.currentUser===void 0&&e(),te.currentUser=t})}),{currentUser:void 0});function Za(e,t){return Xt(J,e,t).catch(()=>Zt(J,e,t))}function $a(){return $t(J,new es)}function en(){return ts(J)}function na(){return te.currentUser!==void 0?te.currentUser:te.then(()=>J.currentUser)}var P=(e=>(e.userLogin="user-login",e.userSetup="user-setup",e.userGetItems="user-get-items",e.userGainCurrency="user-gain-currency",e.chatGetToken="chat-get-token",e.userGetPet="user-get-pet",e.userFeedPet="user-feed-pet",e.marketGetItems="market-get-items",e.marketPurchaseItems="market-purchase-items",e.petGetList="get-pets",e.imageObjectDetection="image-object-detection",e))(P||{});const oa={"user-login":{method:"GET",path:"/user/login",auth:!0,json:!0,params:void 0,response:null},"user-setup":{method:"POST",path:"/user/build",auth:!0,json:!0,params:null,response:null},"user-get-items":{method:"GET",path:"/user/items",auth:!0,json:!0,params:void 0,response:null},"user-gain-currency":{method:"POST",path:"/user/wallet/add",auth:!0,json:!0,params:null,response:null},"chat-get-token":{method:"GET",path:"/chat/get",auth:!0,json:!0,params:void 0,response:null},"user-feed-pet":{method:"POST",path:"/user/pet/grow",auth:!0,json:!0,params:null,response:null},"user-get-pet":{method:"GET",path:"/user/pet/data",auth:!0,json:!0,params:void 0,response:null},"market-get-items":{method:"GET",path:"/market/items",auth:!0,json:!0,params:void 0,response:null},"market-purchase-items":{method:"POST",path:"/market/purchase",auth:!0,json:!0,params:null,response:null},"get-pets":{method:"GET",path:"/pet",auth:!1,json:!0,params:void 0,response:null},"image-object-detection":{method:"POST",path:"/detect",auth:!1,json:!1,params:null,response:null}};async function S(e,t){const s=oa[e];if(!s)throw new Error(`API endpoint ${e} not found`);const a=new URL(`${st.API.BASE_URL}${s.path}`),n=s.method,o={},r={method:n,headers:o};if(s.auth){const c=await Promise.resolve(na()).then(g=>g?.getIdToken());if(!c)throw new Error("User is not authenticated");o.authorization=`Bearer ${c}`}if(t)if(n==="GET")for(const[c,g]of Object.entries(t))a.searchParams.append(c,g);else if(s.json)o["Content-Type"]="application/json",r.body=JSON.stringify(t);else{const c=new FormData;for(const[g,f]of Object.entries(t))c.append(g,f);r.body=c}const i=await fetch(a.toString(),r);if(!i.ok){const c=`API ${e} failed: ${i.status} ${i.statusText}`;throw new Error(c)}return await i.json()}function Me(e,t){return e.slice().sort((s,a)=>{const n=t(s),o=t(a);return n<o?-1:n>o?1:0})}function ra(e){return new Promise(t=>setTimeout(t,e))}const Q=new Map,ia=Symbol();function Le(e,t,s,a){const n=Q.get(e);let o,r,i;if(n){if(n.token===t)return n.promise;o=n.promise,r=n.resolve,i=n.reject,n.token=t}else({promise:o,resolve:r,reject:i}=Promise.withResolvers()),Q.set(e,{promise:o,reject:i,token:t,resolve:r,callback:a});return Promise.resolve(s()).then(c=>{Q.get(e)?.token===t&&(r(c),Q.delete(e),a?.())}).catch(c=>{Q.get(e)?.token===t&&(i(c),Q.delete(e))}),o}async function Ce(e,t){return Le(e,ia,t)}async function B(e,t){return Le(e,Symbol(),t)}const Ae=new Map;async function ca(e,t,s,a=1e3){return Le(e,Symbol(),async()=>{Ae.set(e,t(Ae.get(e))),await ra(a)},()=>{const n=Ae.get(e)??t();return Ae.delete(e),s(n)})}function Ue(e){return BigInt(Math.floor(e.getTime()/864e5))}const ne=new Map,Y=new Set;let q=null,ye=null;function re(e){Y.add(e),Y.size&&!ne.size&&q===null&&ua()}function _(e){ne.delete(e),Y.delete(e),ne.size===0&&q!==null&&(cancelAnimationFrame(q),q=null)}function ua(){const e=t=>{Y.size&&(Y.forEach(a=>{ne.set(a,t)}),Y.clear());const s=ye!==null?t-ye:0;ye=t,Aa(s,t),q=requestAnimationFrame(e)};q=requestAnimationFrame(e)}function Aa(e,t){ne.forEach((s,a)=>a(e,t-s))}let oe=null;var la=(e=>(e[e.Inactived=0]="Inactived",e[e.Detecting=1]="Detecting",e[e.Activated=2]="Activated",e))(la||{});const p=j({pressPosition:{x:0,y:0},currentPosition:{x:0,y:0},lastPosition:{x:0,y:0},INACTIVED:0,DETECTING:1,ACTIVATED:2,get pressPositionVec(){return new E(this.pressPosition.x,this.pressPosition.y)},set pressPositionVec(e){this.pressPosition.x=this.currentPosition.x=this.lastPosition.x=e.x,this.pressPosition.y=this.currentPosition.y=this.lastPosition.y=e.y},get currentPositionVec(){return new E(this.currentPosition.x,this.currentPosition.y)},set currentPositionVec(e){this.lastPosition.x=this.currentPosition.x,this.lastPosition.y=this.currentPosition.y,this.currentPosition.x=e.x,this.currentPosition.y=e.y},get lastPositionVec(){return new E(this.lastPosition.x,this.lastPosition.y)},set lastPositionVec(e){this.lastPosition.x=e.x,this.lastPosition.y=e.y},progress:0,_state:0,get state(){return this._state},set state(e){this._state=e,oe?.controls&&(oe.controls.enabled=e!==2),e===2&&navigator.vibrate?.(50)}});function Ye(e){p.pressPositionVec=new E(e.offsetX,e.offsetY),p.progress=0,p.state=1,re(W)}function W(e,t){if(p.state!=1)return _(W);(p.progress=Math.min(t/v.INTERACT.LONG_PRESS_DURATION,1))>=1&&(p.state=2,W&&_(W))}function da(e){e>v.INTERACT.LONG_PRESS_TROLERANCE&&(_(W),p.state=0)}const m=j({progress:0,additionProgressMax:0,get progressMax(){return v.INTERACT.PET_PROGRESS_BASIC_MAX+this.additionProgressMax},set progressMax(e){this.additionProgressMax=e-v.INTERACT.PET_PROGRESS_BASIC_MAX},opacityDecayTask:{value:0,speed:.001},get opacity(){return Math.max(this.opacityDecayTask.value,0)},set opacity(e){this.opacityDecayTask.value<=0&&pe(this.opacityDecayTask),this.opacityDecayTask.value=e}});let ve=0;function ha(e,t,s){const a=de(fe)?.assets.model?.object;!a||(Ke.setFromCamera(e,t),!Ke.intersectObject(a,!0).length)||(ve+=s,ve>=v.INTERACT.PET_PROGRESS_STEP_THRESHOLD&&(ve=0,m.progress+=1,m.opacity=1.2,m.progress>=m.progressMax&&(m.progress=0,m.additionProgressMax+=2*Math.floor(Math.log2(m.progressMax+1)),Vs(),T.petting=.8)))}function pa(){It(()=>{let e=performance.now();const t=(s,a)=>{if(m.additionProgressMax>0){if(a-e>=v.INTERACT.PET_PROGRESS_MAX_DECAY_INTERVAL){const o=m.progressMax;m.additionProgressMax=Math.floor(m.additionProgressMax/2),m.progress=Math.ceil(m.progress*m.progressMax/o),e=a}}else e=a};return re(t),()=>_(t)})}const se=new Set;function pe(e){se.size||re(it),se.add(e)}function it(e){for(const t of se)t.value-=(t.speed??.001)*e,t.value<=0&&se.delete(t);se.size||_(it)}const T=j({decayTasks:{petting:{value:0,speed:5e-4},upgrade:{value:0,speed:5e-4},feeding:{value:0,speed:5e-4}},get petting(){return Math.max(this.decayTasks.petting.value,0)},set petting(e){this.decayTasks.petting.value<=0&&pe(this.decayTasks.petting),this.decayTasks.petting.value=e},get upgrade(){return Math.max(this.decayTasks.upgrade.value,0)},set upgrade(e){this.decayTasks.upgrade.value<=0&&pe(this.decayTasks.upgrade),this.decayTasks.upgrade.value=e},get feeding(){return Math.max(this.decayTasks.feeding.value,0)},set feeding(e){this.decayTasks.feeding.value<=0&&pe(this.decayTasks.feeding),this.decayTasks.feeding.value=e}}),fe=bt(()=>A.isLegal?{id:A.type,assets:ae[A.type]}:null);let le=null;function fa(){St(()=>{if(!de(fe))return;const e=de(fe).id,t=de(fe).assets;ea(e).then(()=>{const s=oe?.scene;if(!s)return;const a=t.model.object;a&&(a.position.set(0,0,0),a.lookAt(0,0,1),a.visible=!0,s.add(a)),le?.model.object&&le!==t&&s.remove(le.model.object),le=t})})}const ga=function(e){const t=e.querySelector("canvas");if(!t)throw new Error("Canvas element not found");const s=oe=Fa(e,t,b.defaultRoom);function a(o){p.state=0,_(W)}function n(o){switch(p.currentPositionVec=new E(o.offsetX,o.offsetY),p.state){case 0:break;case 1:{const{currentPositionVec:g,pressPositionVec:f}=p,w=g.distanceTo(f);da(w);break}case 2:const{currentPositionVec:r,lastPositionVec:i}=p,c=r.clone().applyMatrix3(s.pointerNormalize);ha(c,s.camera,r.distanceTo(i));break}}return t.addEventListener("pointerdown",Ye),t.addEventListener("pointerup",a),t.addEventListener("pointermove",n),{destroy(){s.dispose(),t.removeEventListener("pointerdown",Ye),t.removeEventListener("pointerup",a),t.removeEventListener("pointermove",n)}}};function qe(){return oe?.controls??null}var ma=D('<div class="longpress-progress tracing-pointer svelte-1n44x8u"></div>'),wa=D('<img alt="" class="hand tracing-pointer svelte-1n44x8u"/>'),ya=D('<div class="petting-progress-bar ignore-pointer svelte-1n44x8u"><div class="fill svelte-1n44x8u"></div></div>'),va=D('<div class="screen-effect svelte-1n44x8u"></div>'),Pa=D('<div class="screen-effect svelte-1n44x8u"></div>'),Ea=D('<div class="screen-effect svelte-1n44x8u"></div>'),Ia=D('<div class="container svelte-1n44x8u"><canvas class="svelte-1n44x8u"></canvas> <!> <!> <!> <!> <!> <!></div>');function Sa(e,t){Rt(t,!0),pa(),fa();var s=Ia(),a=N(je(s),2);{var n=l=>{var u=ma();let d;z(y=>d=x(u,"",d,y),[()=>({"--progress":`${p.progress*100}%`,left:`${p.pressPosition.x??""}px`,top:`${p.pressPosition.y??""}px`})]),V(3,u,()=>H),L(l,u)},o=l=>{var u=Ct(),d=_t(u);{var y=M=>{var G=wa();let ue;z((pt,ft)=>{kt(G,"src",pt),ue=x(G,"",ue,ft)},[()=>ta("hand").src,()=>({left:`${p.currentPosition.x??""}px`,top:`${p.currentPosition.y??""}px`})]),V(3,G,()=>H),L(M,G)};F(d,M=>{p.state==p.ACTIVATED&&M(y)},!0)}L(l,u)};F(a,l=>{p.state==p.DETECTING&&p.progress>.05?l(n):l(o,!1)})}var r=N(a,2);{var i=l=>{var u=ya();let d;var y=je(u);let M;z((G,ue)=>{d=x(u,"",d,G),M=x(y,"",M,ue)},[()=>({opacity:m.opacity}),()=>({width:`${m.progress/m.progressMax*100}%`})]),V(3,u,()=>H),L(l,u)};F(r,l=>{m.opacity&&l(i)})}var c=N(r,2);{var g=l=>{var u=va();let d;z(y=>d=x(u,"",d,y),[()=>({opacity:T.petting,"--color":"pink","--size":"3rem"})]),V(3,u,()=>H,()=>({duration:200})),L(l,u)};F(c,l=>{T.petting&&l(g)})}var f=N(c,2);{var w=l=>{var u=Pa();let d;z(y=>d=x(u,"",d,y),[()=>({opacity:T.upgrade,"--color":"lime"})]),V(3,u,()=>H,()=>({duration:200})),L(l,u)};F(f,l=>{T.upgrade&&l(w)})}var K=N(f,2);{var we=l=>{var u=Ea();let d;z(y=>d=x(u,"",d,y),[()=>({opacity:T.feeding,"--color":"gold","--size":"5rem"})]),V(3,u,()=>H,()=>({duration:200})),L(l,u)};F(K,l=>{T.feeding&&l(we)})}var ce=N(K,2);Tt(ce,()=>t.children??xt),Mt(s,l=>ga?.(l)),L(e,s),Lt()}function ct(){T.feeding=.8}function ut(){T.upgrade=1.2}function ba(e=!1){if(!e)return qe()?.reset();const t=qe();t&&Ra(t,600)}function Ra(e,t){const s=e.object.position.clone(),a=e.position0.clone();function n(o,r){const i=Math.min(r/t,1);s.lerp(a,i),e.object.position.copy(s),e.update(),i>=1&&_(n)}return re(n),n}const tn=Object.freeze(Object.defineProperty({__proto__:null,default:Sa,resetConrols:ba,showFeedingEffect:ct,showUpgradeEffect:ut},Symbol.toStringTag,{value:"Module"})),I=j({});let _e=!1;const U=j([]);let be=null;const A=j({isLegal:!1}),Re={hasRunTodayRoutine:!0};async function Ta(){return await B(Ta,async()=>{const e=await S(P.userLogin);return await Promise.all([xe(e),me(e),ie(e)]),ht(e),!0}).catch(e=>(console.error("[ERR] (GAME SERVICE) Login failed:",e),!1))}async function Ma(e,t){return await B(Ma,async()=>{const s=await S(P.userSetup,{name:e,pet:{growthValue:0,type:t}});return await Promise.all([xe(s),me(s),ie(s)]),ht(s),!0}).catch(s=>(console.error("[ERR] (GAME SERVICE) Setup account failed:",s),!1))}async function La(){return Re.hasRunTodayRoutine?!0:(Re.hasRunTodayRoutine=!0,await Ce(La,async()=>{const e=[S(P.userGainCurrency,{action:"LOGIN",isARMode:!1}).then(dt)];return await Promise.all(e),!0}).catch(e=>(console.error("[ERR] (GAME SERVICE) Daily routine failed:",e),!1)))}async function Ca(){return U.length>0&&be&&be>new Date?U:await Ce(Ca,async()=>{const e=await S(P.marketGetItems);return await xe(e)}).catch(e=>{console.error("[ERR] (GAME SERVICE) Get market items failed:",e)})}async function _a(){return!_e&&Object.keys(I).length>0?I:await B(_a,async()=>{const e=await S(P.userGetItems);return await me(e)}).catch(e=>{console.error("[ERR] (GAME SERVICE) Get user items failed:",e)})}async function xa(e,t){return await B(xa,async()=>{const s=await S(P.marketPurchaseItems,{items:{[e.itemId]:t}});return await me(s)}).catch(s=>{console.error("[ERR] (GAME SERVICE) Purchase item failed:",s)})}async function ka(){return A.isLegal?A:await B(ka,async()=>{const e=await S(P.userGetPet);return await ie(e),A.isLegal?A:void 0}).catch(e=>{console.error("[ERR] (GAME SERVICE) Get pet info failed:",e)})}async function Oa(e,t=1){return await B(Oa,async()=>{const s=await S(P.userFeedPet,{items:{[e]:t}});return await Promise.all([lt(s),ie(s)]),!0}).catch(s=>(console.error("[ERR] (GAME SERVICE) Feed pet failed:",s),!1))}async function ja(){return await ca(ja,Da,async e=>{const t=await S(P.userFeedPet,{items:e});await Promise.all([lt(t),ie(t)])}).then(()=>!0).catch(e=>(console.error("[ERR] (GAME SERVICE) Shortcut feed pet failed:",e),!1))}function Da(e={}){const t=[R.premiumFood,R.generalFood];let s=null;for(const a of t)if(I[a]&&I[a].quantity>0){s=a;break}return s&&(_e=!0,e[s]=(e[s]??0)+1,I[s].quantity--,ct(),A.isLegal&&(A.growthValue+=Ve.FOOD_GROWTH_VALUES[s],A.growthValue>=A.aimValue&&(A.growthValue-=A.aimValue,A.level++,A.aimValue=Ve.PET_LEVEL_REQUIREMENTS[A.level]??A.aimValue,ut()))),e}async function Ba(){return await Ce(Ba,async()=>(await S(P.petGetList)).pets).catch(e=>{console.error("[ERR] (GAME SERVICE) Get pet intro list failed:",e)})}async function At(e){return await B(At,async()=>{const t=await S(P.userGainCurrency,{action:e,isARMode:!1});return dt(t),!0}).catch(t=>(console.error("[ERR] (GAME SERVICE) Earn currency failed:",t),!1))}async function xe(e){const t=new Date;return be=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1),U.splice(0,U.length,...e.market),await Te(U.map(s=>s.itemId)),Me(U,s=>s.itemId)}async function me(e){const t=e.backpack.map(a=>a.itemId),s=Me(e.backpack,a=>a.itemId);await Te(t);for(const a in I)a!=="dirty"&&delete I[a];for(const a of s)I[a.itemId]=a;return _e=!1,I}async function lt(e){const t=e.foods.map(a=>a.itemId),s=Me(e.foods,a=>a.itemId);await Te(t);for(const a of s)I[a.itemId]=a;return s}async function ie(e){return A.isLegal=!0,A.isLegal&&(A.level=e.pet.level,A.type=e.pet.type,A.growthValue=e.pet.growthValue,A.aimValue=e.pet.aimValue),A}function dt(e){e.currencies.forEach(t=>{const s=I[t.coinId];s&&(s.quantity=t.amount)})}function ht(e){const t=Ue(new Date(e.lastLoginTime)),s=Ue(new Date);Re.hasRunTodayRoutine=t===s}function We(e){const t=e/100;let s,a,n;return t<=66?s=255:(s=t-60,s=329.698727446*Math.pow(s,-.1332047592),s<0&&(s=0),s>255&&(s=255)),t<=66?(a=t,a=99.4708025861*Math.log(a)-161.1195681661):(a=t-60,a=288.1221695283*Math.pow(a,-.0755148492)),a<0&&(a=0),a>255&&(a=255),t>=66?n=255:t<=19?n=0:(n=t-10,n=138.5177312231*Math.log(n)-305.0447927307,n<0&&(n=0),n>255&&(n=255)),new Ot(s/255,a/255,n/255)}class Ga{enabled=!1;sensitivities={pitch:.5,yaw:.5,roll:1};deviceEuler=new De;deviceQuat=new k;baseQuat=new k;deltaQuat=new k;finalQuat=new k;screenTransform=new k;worldTransform=new k(-Math.sqrt(.5),0,0,Math.sqrt(.5));hasBase=!1;constructor(t=.5,s=.5,a=1){this.sensitivities={pitch:t,yaw:s,roll:a},this.onDeviceOrientationChange=this.onDeviceOrientationChange.bind(this),this.onScreenOrientationChange=this.onScreenOrientationChange.bind(this)}async enable(){if(typeof DeviceOrientationEvent.requestPermission=="function")try{await DeviceOrientationEvent.requestPermission()==="granted"&&this.start()}catch(t){console.error("Permission denied or error:",t)}else this.start()}start(){this.enabled=!0,window.addEventListener("deviceorientation",this.onDeviceOrientationChange,!1),window.addEventListener("orientationchange",this.onScreenOrientationChange,!1),this.onScreenOrientationChange()}stop(){this.enabled=!1,window.removeEventListener("deviceorientation",this.onDeviceOrientationChange),window.removeEventListener("orientationchange",this.onScreenOrientationChange)}onScreenOrientationChange(){const t=window.orientation?X.degToRad(Number(window.orientation)):0;this.screenTransform.setFromAxisAngle(new O(0,0,1),-t)}onDeviceOrientationChange(t){if(!this.enabled)return;const s=t.alpha?X.degToRad(t.alpha):0,a=t.beta?X.degToRad(t.beta):0,n=t.gamma?X.degToRad(t.gamma):0,o=window.orientation?X.degToRad(Number(window.orientation)):0;this.deviceEuler.set(a,s,-n,"YXZ"),this.deviceQuat.setFromEuler(this.deviceEuler),this.deviceQuat.multiply(this.worldTransform);const r=-o/2,i=Math.sin(r),c=Math.cos(r),g=new k(0,0,i,c);this.deviceQuat.multiply(g),this.hasBase||(this.baseQuat.copy(this.deviceQuat),this.hasBase=!0)}applyTo(t){if(!this.enabled||!this.hasBase)return;this.deltaQuat.copy(this.baseQuat).invert().multiply(this.deviceQuat);const s=new De().setFromQuaternion(this.deltaQuat,"YXZ");s.x*=this.sensitivities.pitch,s.y*=this.sensitivities.yaw,s.z*=this.sensitivities.roll,this.finalQuat.setFromEuler(s),t.quaternion.multiply(this.finalQuat)}recenter(){this.hasBase=!1}}const Je={[b.defaultRoom]:{info:void 0,lights(){const e=[],t=new Be(16777215,1);e.push(t);const s=new ze(We(3e3),10);return e.push(s),s.target.position.set(0,0,0),s.position.set(-.6240303246453015,.18594304681632223,-.7589543709462294).setLength(2.5),s.castShadow=!0,s.shadow.mapSize.width=2048,s.shadow.mapSize.height=2048,s.shadow.normalBias=2**-6,s.shadow.bias=-.00390625,s.shadow.camera.near=.0625,s.shadow.camera.far=6,e},camera(){const e=new he(v.THREE.FIELD_OF_VIEW,1,v.THREE.NEAR_CLIPPING_PLANE,v.THREE.FAR_CLIPPING_PLANE);return e.lookAt(0,.125,0),e.position.set(0,.185,.3),e},updateControls(e){e.update()},controls(e,t){const s=new Ge(e,t);return s.target.set(0,.08,0),s.minPolarAngle=Math.PI/8,s.maxPolarAngle=Math.PI*9/16,s.minDistance=.15,s.maxDistance=.6,s.enableDamping=!0,s.enablePan=!1,s},composerPasses(e,t,s){const{width:a,height:n}=e.getSize(new E),o=new Ne(t,s);o.params.saoBias=.5,o.params.saoIntensity=.002,o.params.saoScale=2,o.params.saoKernelRadius=16,o.params.saoMinResolution=0,o.params.saoBlur=!0,o.params.saoBlurRadius=8,o.params.saoBlurStdDev=4,o.params.saoBlurDepthCutoff=.01;const r=new Fe(new E(a,n),.125,.03125,.995),i=new Dt(t,s,{focus:.5,aperture:.0125,maxblur:.01});return{passes:[o,r,i],sizeUpdate(c,g){const{width:f,height:w}=e.getSize(new E);r.setSize(f,w)}}},async loadScene(e){await Qe(b.defaultRoom).then(t=>{const s=t.models.room;s.object&&e.add(s.object);const a=t.environment;if(a?.envMap){const n=Math.PI*5/6;e.environment=a.envMap,e.environmentRotation.y=n,e.environmentIntensity=1,e.background=a.envMap,e.backgroundRotation.y=n}})}},[b.throwingBallGame]:{info:{isDeviceOrientationSupported:"DeviceOrientationEvent"in window&&typeof DeviceOrientationEvent=="function",gyroTuner:new Ga},lights(){const e=new ze(We(4e3),4);return e.target.position.set(0,0,0),e.position.set(-.5958726680193351,.6671024520583918,-.44711337270090057).setLength(4),e.castShadow=!0,e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.camera.near=.0625,e.shadow.camera.far=12,e.shadow.intensity=1,e.shadow.bias=-.001953125,[e]},camera(){const e=new he(v.THREE.FIELD_OF_VIEW,1,v.THREE.NEAR_CLIPPING_PLANE,v.THREE.FAR_CLIPPING_PLANE);return e.position.set(0,.0859375,-1/2**12),e.lookAt(new O(0,.0859375,1)),e},composerPasses(e,t,s){const{width:a,height:n}=e.getSize(new E),o=new Ne(t,s);o.params.saoBias=.5,o.params.saoIntensity=.002,o.params.saoScale=2,o.params.saoKernelRadius=8,o.params.saoMinResolution=0,o.params.saoBlur=!0,o.params.saoBlurRadius=8,o.params.saoBlurStdDev=4,o.params.saoBlurDepthCutoff=.01;const r=new Fe(new E(a,n),.125,.03125,.995);return{passes:[o,r],sizeUpdate(i,c){const{width:g,height:f}=e.getSize(new E);r.setSize(g,f)}}},async loadScene(e){await Qe(b.throwingBallGame).then(t=>{const s=t.models.field;s.object&&e.add(s.object);const a=t.environment;if(a?.envMap){const n=Math.PI;e.environment=a.envMap,e.environmentRotation.y=n,e.environmentIntensity=1,e.background=a.envMap,e.backgroundRotation.y=n}})},updateControls(e){e.update(),this.info.gyroTuner.applyTo(e.object)},controls(e,t){const s=new Ge(e,t);return s.target.set(0,.0859375,0),s.rotateSpeed=-.5,s.minPolarAngle=Math.PI*3/7,s.maxPolarAngle=Math.PI*3/5,s.maxDistance=1/2**12,s.enablePan=!1,s.enableZoom=!1,s.enableDamping=!0,s.dampingFactor=.1,s}},[b.hideNSeekGame]:{info:void 0,lights(){const e=[],t=new Be(16777215,3);return e.push(t),t.position.set(.5,1,.25),e},camera(){const e=new he(v.THREE.FIELD_OF_VIEW,1,v.THREE.NEAR_CLIPPING_PLANE,v.THREE.FAR_CLIPPING_PLANE);return e.position.set(0,1,0),e.lookAt(0,0,0),e},updateControls(e){e.update()},controls(e,t){const s=new jt(e,t);return s.enableRotate=!1,s.enableZoom=!1,s.enablePan=!1,s}}};function Na(e){const t=new Yt;if(e.lights)for(const a of e.lights())t.add(a);const s=e.camera();return t.add(s),e.loadScene&&e.loadScene(t),{scene:t,camera:s}}function Fa(e,t,s){const{clientWidth:a,clientHeight:n}=e;if(typeof s=="string"){if(!Je[s])throw new Error(`SceneInfo '${s}' not found.`);s=Je[s]}const o=s,{scene:r,camera:i}=Na(o),c=[],g=o.controls(i,t),f=new Bt({canvas:t,alpha:!0,antialias:!0});f.setPixelRatio(window.devicePixelRatio),f.shadowMap.enabled=!0,f.shadowMap.type=Gt,f.toneMapping=Nt,f.outputColorSpace=Ze;const w=new Ft(f);{w.setPixelRatio(window.devicePixelRatio),w.setSize(a,n);const u=new zt(r,i);if(w.addPass(u),o.composerPasses){const{passes:d,sizeUpdate:y}=o.composerPasses(f,r,i);for(const M of d)w.addPass(M);y&&c.push(y)}w.addPass(new Vt),w.addPass(new Ht)}const K=new Qt().set(2/a,0,-1,0,-2/n,1,0,0,1);function we(){const{clientWidth:u,clientHeight:d}=e;i instanceof he&&(i.aspect=u/d,i.updateProjectionMatrix()),f.setSize(u,d),w.setSize(u,d);for(const y of c)y(u,d);K.set(2/u,0,-1,0,-2/d,1,0,0,1)}const ce=new ResizeObserver(we);ce.observe(e);function l(u){o.updateControls&&o.updateControls(g),w.render(u)}return re(l),{scene:r,camera:i,controls:g,info:s.info,pointerNormalize:K,dispose:()=>{_(l),f.dispose(),w&&w.dispose(),ce.disconnect()}}}const Ke=new Ut,Xe=localStorage.getItem("veggibuddy-settings"),za=j(Xe?JSON.parse(Xe):{sound:!0,music:!0}),Va={set(e,t,s){return e[t]=s,localStorage.setItem("veggibuddy-settings",JSON.stringify(e)),!0}},Ha=new Proxy(za,Va);export{P as A,re as B,ba as C,_ as D,st as E,Ka as F,xa as G,Ca as H,R as I,U as J,_a as K,Oa as L,Qe as M,ea as N,Fa as O,C as P,$s as Q,ae as R,b as S,Ke as T,tn as U,$a as a,Ba as b,na as c,Ta as d,ra as e,Ja as f,Xa as g,ka as h,Ha as i,en as j,ja as k,Wa as l,at as m,I as n,Ya as o,A as p,qa as q,La as r,Za as s,ot as t,Ma as u,nt as v,S as w,Ee as x,Pe as y,At as z};
