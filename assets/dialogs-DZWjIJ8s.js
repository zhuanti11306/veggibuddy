import{d as u,p as g,i as h,c as v,e as m,f as D,a as _,b as d,g as k,$ as B,h as w,j as l,k as b,l as O,s as x,t as K,m as C,n as I}from"./vendor-BEoA47yD.js";var S=(o,e,n)=>o.target===o.currentTarget&&e(o,l(n)),U=w('<div class="backdrop svelte-sqahei" role="presentation"><!></div>');function j(o,e){g(e,!1);function n(s){if(s.key==="Escape"&&r.length>0){s.preventDefault(),s.stopPropagation();const t=T();t&&t.closeByKeyboard&&t.close(void 0)}}function a(s,t){s.target===s.currentTarget&&t.closeByOverlay&&t.close(void 0)}h();var i=v();m("keydown",B,n);var p=D(i);_(p,1,()=>r,s=>s.id,(s,t)=>{const f=b(()=>l(t).component);var c=U();c.__click=[S,a,t];var y=O(c);l(f)(y,x(()=>l(t).props)),K(3,c,()=>C,()=>({duration:250})),d(s,c)}),d(o,i),k()}u(["click"]);const $=crypto.randomUUID?()=>crypto.randomUUID():(()=>{let o=0n;return()=>(o++,`dialog-${(performance.now()%1e12).toString().padStart(12,"0")}-${o.toString().padStart(6,"0")}`)})();class L{id=$();component;props;lifecycle;resolveLifecycle;closeByKeyboard;closeByOverlay;constructor(e,n,a){this.component=e,this.props={...n,dialog:this,closeDialog:s=>this.close(s)},this.closeByKeyboard=a?.closeByKeyboard??!0,this.closeByOverlay=a?.closeByOverlay??!0;const{promise:i,resolve:p}=Promise.withResolvers();this.lifecycle=i,this.resolveLifecycle=p}close(e){this.resolveLifecycle(e)}}const r=I([]);function E(o,e){const n=e?.props??{},a=new L(o,n,e);return r.push(a),a.lifecycle.finally(()=>P(a)),a.lifecycle}function T(){return r.at(-1)}function q(o){return r.findIndex(e=>e===o)}function P(o){const e=q(o);e!==-1&&(e===r.length-1&&r.pop(),r.splice(e,1))}export{j as C,E as o};
