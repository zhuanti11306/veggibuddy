import{h as d,I as R,A as h,b as u,J as O,l as a,K as Y,p as V,q as J,g as $,f as G,u as N,C as c,t as Z,L as tt,M as K,j as o,w as L,B,H as et,N as A,d as U,G as st,O as at,F as w}from"./vendor-BEoA47yD.js";import{p as C,h as ot,i as M,j as nt,r as rt,k as lt,n as S,I as j,o as it,q as ct,t as q,v as vt}from"./settings.svelte-DYwtrQ_B.js";import{g as D}from"./index-4nzEmBf-.js";import{g as ut}from"./index-B-RR9znf.js";import{g as dt}from"./index-B9L6Kbcp.js";import{o as _t}from"./dialogs-DZWjIJ8s.js";import"./firebase-LKE9M92C.js";import"./page-BbvZNm-6.js";const bt=(s,t)=>{let e;const l=t?.duration??500,v=n=>{n.button===0&&(e=window.setTimeout(()=>{e=void 0,t?.onlongpress?.(n)},l))},_=n=>{n.button===0&&e&&(clearTimeout(e),e=void 0,t?.onclick?.(n))},p=n=>{e&&(clearTimeout(e),e=void 0)};return s.addEventListener("pointerdown",v),s.addEventListener("pointerup",_),s.addEventListener("pointerleave",p),{update(n){t=n},destroy(){s.removeEventListener("pointerdown",v),s.removeEventListener("pointerup",_),s.removeEventListener("pointerleave",p)}}};var gt=d("<div><!></div>");function H(s,t){var e=gt(),l=a(e);R(l,()=>t.children??O),h(()=>Y(e,1,`button-list ${t.position??""}`,"svelte-85gwiu")),u(s,e)}var pt=d('<div class="shortcut-list svelte-17m5ggq"><!></div>'),mt=d("<!> <!>",1);function ft(s,t){V(t,!0);let e=J(t,"showShortcuts",15,!1),l=J(t,"activateShortcuts",3,!0);function v(){e(!e())}H(s,{get position(){return t.position},children:(_,p)=>{var n=mt(),k=G(n);{var E=r=>{var b=pt(),i=a(b);R(i,()=>t.shortcuts,()=>v),Z(3,b,()=>tt,()=>({duration:250,axis:"y"})),u(r,b)};N(k,r=>{t.shortcuts&&e()&&l()&&r(E)})}var x=c(k,2);R(x,()=>t.children??O,()=>v),u(_,n)}}),$()}var ht=d('<div class="level-container svelte-1y2gtf8"><div class="level svelte-1y2gtf8"><span class="label svelte-1y2gtf8">LEVEL</span> <span class="value svelte-1y2gtf8"> </span> <span class="progress-bar svelte-1y2gtf8"><span class="progress svelte-1y2gtf8"></span> <span class="progress-label svelte-1y2gtf8"> </span></span></div></div>');function kt(s,t){V(t,!0);const e=L(()=>C.isLegal?C:{}),l=L(()=>A(o(e).level,NaN)),v=L(()=>A(o(e).aimValue,NaN)),_=L(()=>A(o(e).growthValue,NaN));K(()=>{C.isLegal||ot()});var p=ht(),n=a(p),k=c(a(n),2),E=a(k),x=c(k,2),r=a(x),b=c(r,2),i=a(b);h(g=>{B(E,o(l)),et(r,`width: ${g??""}%;`),B(i,`${o(_)??""} / ${o(v)??""}`)},[()=>Math.min(o(_)/o(v),1)*100]),u(s,p),$()}var yt=(s,t)=>(t.dialog.close(),nt(),D("/")),jt=(s,t)=>t.dialog.close(),Lt=d('<div class="modal svelte-9rfbh6"><h1 class="title svelte-9rfbh6">選單</h1> <button type="button" class="svelte-9rfbh6"> </button> <button type="button" class="svelte-9rfbh6">登出</button> <button type="button" class="svelte-9rfbh6">關閉選單</button></div>');function wt(s,t){V(t,!0);var e=Lt(),l=c(a(e),2);l.__click=()=>M.sound=!M.sound;var v=a(l),_=c(l,2);_.__click=[yt,t];var p=c(_,2);p.__click=[jt,t],h(()=>B(v,`音效：${M.sound?"開":"關"}`)),u(s,e),$()}U(["click"]);var Et=()=>_t(wt),Ft=d('<button type="button" class="button svelte-k1ejc0"><img alt="選單" draggable="false" class="svelte-k1ejc0"/> <span class="label svelte-k1ejc0">選單</span></button>'),It=()=>D("./chat"),Pt=()=>D("./shop"),St=d('<button type="button" class="button svelte-k1ejc0"><img alt="對話" draggable="false" class="svelte-k1ejc0"/> <span class="label svelte-k1ejc0">對話</span></button> <button type="button" class="button svelte-k1ejc0"><img alt="商店" draggable="false" class="svelte-k1ejc0"/> <span class="label svelte-k1ejc0">商店</span></button>',1),qt=(s,t)=>o(t).count>0&&lt(),xt=d('<button type="button" class="button shortcut-button svelte-k1ejc0"><img alt="餵食" draggable="false" class="svelte-k1ejc0"/> <span class="label svelte-k1ejc0"> </span></button>'),Nt=()=>ut(),Bt=d('<button type="button" class="button shortcut-button svelte-k1ejc0"><img alt="丟球" draggable="false" class="svelte-k1ejc0"/> <span class="label svelte-k1ejc0">丟球</span></button>'),Vt=()=>dt(),$t=d('<button type="button" class="button shortcut-button svelte-k1ejc0"><img alt="捉迷藏" draggable="false" class="svelte-k1ejc0"/> <span class="label svelte-k1ejc0">捉迷藏</span></button>'),Dt=d("<!> <!> <!>",1),Tt=d('<button type="button" class="button svelte-k1ejc0"><img alt="背包" draggable="false" class="svelte-k1ejc0"/> <span class="label svelte-k1ejc0">背包</span></button>'),At=d('<main class="svelte-k1ejc0"><!> <!> <!> <!></main>');function Ut(s,t){V(t,!0),K(()=>{rt()});let e=L(()=>{let r=0,b=null;return S[j.premiumFood]?.quantity&&(b=j.premiumFood,r+=S[j.premiumFood].quantity),S[j.generalFood]?.quantity&&(b=j.generalFood,r+=S[j.generalFood].quantity),{id:b,count:r}}),l=L(()=>!!S[j.ball]),v=L(()=>!!S[j.veggieCam]),_=L(()=>o(l)||o(v)||o(e).id!==null);st(()=>(it(),()=>ct()));var p=At(),n=a(p);kt(n,{});var k=c(n,2);H(k,{position:"top-right",children:(r,b)=>{var i=Ft();i.__click=[Et];var g=a(i);h(()=>w(g,"src",q.settings.src)),u(r,i)}});var E=c(k,2);H(E,{position:"bottom-left",children:(r,b)=>{var i=St(),g=G(i);g.__click=[It];var y=a(g),F=c(g,2);F.__click=[Pt];var I=a(F);h(()=>{w(y,"src",q.chat.src),w(I,"src",q.shop.src)}),u(r,i)}});var x=c(E,2);ft(x,{position:"bottom-right",get activateShortcuts(){return o(_)},shortcuts:i=>{var g=Dt(),y=G(g);{var F=m=>{var f=xt();f.__click=[qt,e];var P=a(f),W=c(P,2),X=a(W);h(()=>{w(P,"src",vt[o(e).id].src),B(X,`餵食 ${o(e).count??""}`)}),u(m,f)};N(y,m=>{o(e).id&&m(F)})}var I=c(y,2);{var T=m=>{var f=Bt();f.__click=[Nt];var P=a(f);h(()=>w(P,"src",q.ball.src)),u(m,f)};N(I,m=>{o(l)&&m(T)})}var z=c(I,2);{var Q=m=>{var f=$t();f.__click=[Vt];var P=a(f);h(()=>w(P,"src",q.camera.src)),u(m,f)};N(z,m=>{o(v)&&m(Q)})}u(i,g)},children:(i,g=O)=>{var y=Tt(),F=a(y);at(y,(I,T)=>bt?.(I,T),()=>({onclick:()=>D("./backpack"),onlongpress:g()})),h(()=>w(F,"src",q.inventory.src)),u(i,y)},$$slots:{shortcuts:!0,default:!0}}),u(s,p),$()}U(["click"]);export{Ut as default};
