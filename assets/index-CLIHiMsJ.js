import{g as s,s as t,a as e,b as a,o as l,c as n,u as o,m as i,d as c,e as r,f as v,r as p,l as u,h as d,i as y}from"./index-BruxziNw.js";import{e as f,r as b,u as m,q as g,S as h,d as w,p as _,a as q,f as k,s as I,c as x,g as D,b as j,h as P,t as B,i as V,j as F,k as G,l as L,m as O,n as S,o as z,v as A,w as C,x as E,y as K,z as M,A as T,B as $,C as H}from"./index-B74hZ3uX.js";function J(s,t){return s===t||s?.[h]===t}function N(s={},t,e,a){return f(()=>{var a,l;return b(()=>{a=l,l=[],m(()=>{s!==e(...l)&&(t(s,...l),a&&J(e(...a),s)&&t(null,...a))})}),()=>{g(()=>{l&&J(e(...l),s)&&t(null,...l)})}}),s}async function Q(s,t){try{await a(),t.dialog.close()}catch(e){}}var R=(s,t)=>t(1),U=(s,t)=>t(2),W=k('<div class="dialog svelte-o27yn2"><div class="stages svelte-o27yn2"><div class="stage-container svelte-o27yn2"><form class="stage svelte-o27yn2"><h1 class="svelte-o27yn2">註冊或登入</h1> <label class="input-slot svelte-o27yn2"><span class="svelte-o27yn2">電子郵件</span> <input type="email" name="email" class="input svelte-o27yn2" placeholder="請輸入使用者帳戶電子郵件" autocomplete="email" required/></label> <div class="spacer svelte-o27yn2"></div> <button type="submit" class="button primary svelte-o27yn2">下一步</button> <button type="button" class="button secondary svelte-o27yn2">取消</button> <hr class="divider svelte-o27yn2"/> <button type="button" class="button secondary svelte-o27yn2"><img alt="Google Icon" class="svelte-o27yn2"/> 使用 Google 登入</button></form> <form class="stage svelte-o27yn2"><h1 class="svelte-o27yn2">帳戶密碼</h1> <label class="input-slot svelte-o27yn2"><span class="svelte-o27yn2">密碼</span> <input type="password" name="password" class="input svelte-o27yn2" placeholder="請輸入使用者密碼" autocomplete="new-password" required/></label> <div class="spacer svelte-o27yn2"></div> <p class="error-text svelte-o27yn2"> </p> <p class="loading-text svelte-o27yn2"> </p> <button type="submit" class="button primary svelte-o27yn2">下一步</button> <button type="button" class="button secondary svelte-o27yn2">上一步</button></form></div></div></div>');function X(a,l){_(l,!0);let n=j(null),o=j(null),i=j(void 0),c=j(void 0),r=q({email:"",password:""});function v(s){switch(s){case 1:l.dialog.close();break;case 2:D(n)?.scrollIntoView({behavior:"smooth"})}}var p=W(),u=x(p),d=x(u),y=x(d),f=I(x(y),8);f.__click=[R,v];var b=I(f,4);b.__click=[Q,l];var m=x(b);N(y,s=>P(n,s),()=>D(n));var g=I(y,2),h=I(x(g),6),w=x(h),k=I(h,2),O=x(k);I(k,4).__click=[U,v],N(g,s=>P(o,s),()=>D(o)),B(s=>{t(m,"src",s),V(w,D(c)),V(O,D(i))},[()=>s("googleIcon").src]),F("submit",y,function(s){if(s.preventDefault(),!D(n))return;const t=new FormData(D(n));(r.email=t.get("email"))&&D(o)&&(D(o).reset(),D(o).scrollIntoView({behavior:"smooth"}))}),F("submit",g,async function(s){if(s.preventDefault(),!D(o))return;const t=new FormData(D(o));if(r.password=t.get("password"))try{P(i,"載入中……"),P(c,void 0),await e(r.email,r.password),l.closeDialog()}catch(a){P(c,"登入失敗，請檢查您的電子郵件和密碼是否正確。")}finally{P(i,void 0)}}),G(a,p),L()}function Y(s,t){const e=s.target;P(t,e.value,!0)}function Z(s,t,e){const a=s.target;if(!D(t))return;const l=D(t).get(a.value);P(e,l?{name:l.name,type:l.typeId}:null,!0)}w(["click"]);var ss=k("<option> </option>"),ts=(s,t)=>t(1),es=(s,t)=>t(2),as=k('<div class="dialog svelte-1q9yfp0"><div class="stages svelte-1q9yfp0"><div class="stage-container svelte-1q9yfp0"><div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">事前準備</h1> <p>在我們開始之前，告訴我你的名字吧！不需要告訴我你的真實姓名，而是給讓我知道我應該怎麼稱呼你。</p> <label class="input-slot svelte-1q9yfp0"><span class="svelte-1q9yfp0">暱稱</span> <input class="input svelte-1q9yfp0" name="nickname" type="text" placeholder="請輸入您的暱稱" autocomplete="nickname"/></label> <div class="spacer svelte-1q9yfp0"></div> <button class="button primary svelte-1q9yfp0">下一步</button></div> <div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">選擇寵物</h1> <p>選擇一隻與你合拍的小夥伴吧！在之後的每一天，你們將會一起交流、一起成長。</p> <div class="input-slot svelte-1q9yfp0"><span class="svelte-1q9yfp0">寵物</span> <select class="input svelte-1q9yfp0" name="pet"><option disabled selected>請選擇您的寵物</option><!></select></div> <div class="spacer svelte-1q9yfp0"></div> <div class="description svelte-1q9yfp0"><!></div> <button class="button primary svelte-1q9yfp0">下一步</button> <button class="button secondary svelte-1q9yfp0">上一步</button></div> <div class="stage svelte-1q9yfp0"><h1 class="svelte-1q9yfp0">最終確認</h1> <p>最後，讓我們確認一下。<strong> </strong>，我將會如此稱呼你，而你選擇的<strong> </strong>將會是你的夥伴。<br/> 沒有問題的話，我們就可以出發啦。</p> <div class="spacer svelte-1q9yfp0"></div> <button class="button primary svelte-1q9yfp0">完成</button> <button class="button secondary svelte-1q9yfp0">返回</button></div></div></div></div>');function ls(s,t){_(t,!0);let e=q([]),a=j(!1),i=j(""),c=j(null),r=j(null);async function v(){P(a,!0),await o(D(i),D(c).type),t.dialog.close()}function p(s){return t=>{t.currentTarget.disabled||s()}}function u(s){const t=e[s-1];t?.scrollIntoView({behavior:"smooth"})}l(()=>{let s=!1;return n().then(t=>{if(s)return;const e=new Map;if(t)for(const s of t)e.set(s.typeId,s);P(r,e,!0)}),()=>s=!0});var d=as(),y=x(d),f=x(y),b=x(f),m=I(x(b),4);I(x(m),2).__input=[Y,i];var g=I(m,4),h=O(()=>p(()=>u(2)));g.__click=function(...s){D(h)?.apply(this,s)},N(b,s=>e[0]=s,()=>e?.[0]);var w=I(b,2),k=I(x(w),4),F=I(x(k),2);F.__input=[Z,r,c];var C=x(F);C.value=C.__value="";var E=I(C);S(E,17,()=>D(r)?D(r).values():[],s=>s.typeId,(s,t)=>{var e=ss(),a=x(e),l={};B(()=>{V(a,D(t).name),l!==(l=D(t).typeId)&&(e.value=(e.__value=D(t).typeId)??"")}),G(s,e)});var K=I(k,4),M=x(K),T=s=>{var t=A();B(s=>V(t,s),[()=>D(r).get(D(c).type)?.description]),G(s,t)},$=s=>{var t=A("請選擇您的寵物");G(s,t)};z(M,s=>{D(c)&&D(r)?s(T):s($,!1)});var H=I(K,2),J=O(()=>p(()=>u(3)));H.__click=function(...s){D(J)?.apply(this,s)},I(H,2).__click=[ts,u],N(w,s=>e[1]=s,()=>e?.[1]);var Q=I(w,2),R=I(x(Q),2),U=I(x(R)),W=x(U),X=I(U,2),ls=x(X),ns=I(R,4),os=O(()=>p(v));ns.__click=function(...s){D(os)?.apply(this,s)},I(ns,2).__click=[es,u],N(Q,s=>e[2]=s,()=>e?.[2]),B(()=>{g.disabled=!D(i),H.disabled=!D(c),V(W,D(i)),V(ls,D(c)?.name),ns.disabled=D(a)||!D(i)||!D(c)}),G(s,d),L()}async function ns(s,t,e){D(t)||"Enter"!==s.key&&" "!==s.key||await e()}w(["input","click"]);var os=k('<div class="main svelte-17toa27" role="button" tabindex="-1"><img class="brand svelte-17toa27" alt="菜菜小伙伴"/> <p class="hint svelte-17toa27"> </p></div>'),is=k('<p class="loading-text svelte-17toa27">載入中...</p>'),cs=k('<div class="loading svelte-17toa27"><p>此應用仍在開發中，<br/> 功能可能不完整或有錯誤<br/> 歡迎隨時回報問題！:D<br/></p> <!></div>');function rs(s,e){_(e,!0);let a=j(void 0);async function l(){if(D(a))return;let s=r();s instanceof Promise&&(P(a,"正在檢查登入狀態..."),s=await r(),P(a,void 0)),null===s&&await $(X),null!==s&&(await async function(){P(a,"正在載入使用者資料……"),await v()||await $(ls,{closeByOverlay:!1,closeByKeyboard:!1}),P(a,"正在載入遊戲資料……"),await Promise.all([p(),u()])}(),H("/game"))}var n=C(),o=E(n);K(o,()=>us,s=>{var t=cs(),e=I(x(t),2);K(e,()=>us.assetLoading,s=>{var t=is();M(3,t,()=>T),G(s,t)}),M(3,t,()=>T),G(s,t)},s=>{var e=os();let n;e.__click=l,e.__keydown=[ns,a,l];var o=x(e),r=I(o,2),v=x(r);B(s=>{n=c(e,"",n,s),t(o,"src",i.title.src),V(v,D(a)??"點擊任意位置開始")},[()=>({"background-image":`url(${i.mainScreen.src})`})]),G(s,e)}),G(s,n),L()}w(["click","keydown"]);const vs=Promise.all([y(),d(1500)]),ps=d(3e3),us=Object.assign(Promise.all([vs,ps]),{assetLoading:vs});export{rs as default,us as showingLoadingScreen};
