import{J as t,K as e,L as a,u as s,r as i,M as l,p as n,f as v,s as r,c,t as m,i as d,j as u,k as o,l as p,o as h,g,b,m as f,h as y,B as z,z as x,A as q,d as k,y as $,n as _,N as w}from"./index-B74hZ3uX.js";import{H as I,s as M,v as D,J as j,I as E,K as S,L as A,y as J}from"./index-BruxziNw.js";function K(n,v,r=v){var c=new WeakSet;t(n,"input",async t=>{var s=t?n.defaultValue:n.value;if(s=L(n)?B(s):s,r(s),null!==e&&c.add(e),await a(),s!==(s=v())){var i=n.selectionStart,l=n.selectionEnd;n.value=s??"",null!==l&&(n.selectionStart=i,n.selectionEnd=Math.min(l,n.value.length))}}),null==s(v)&&n.value&&(r(L(n)?B(n.value):n.value),null!==e&&c.add(e)),i(()=>{var t=v();if(n===document.activeElement){var a=l??e;if(c.has(a))return}L(n)&&t===B(n.value)||("date"!==n.type||t||n.value)&&t!==n.value&&(n.value=t??"")})}function L(t){var e=t.type;return"number"===e||"range"===e}function B(t){return""===t?null:+t}var H=v('<div class="success-content svelte-1gtgz23"><div class="item-display svelte-1gtgz23"><img class="item-image svelte-1gtgz23"/> <div class="item-info svelte-1gtgz23"><div class="item-name svelte-1gtgz23"> </div></div></div> <p class="hint svelte-1gtgz23">點擊空白位置以關閉</p></div>');function N(t,e){n(e,!0);var a=H(),s=c(a),i=c(s),l=r(i,2),v=c(l),h=c(v);m(t=>{M(i,"src",t),M(i,"alt",e.item.name),d(h,`獲得：${e.item.name??""} × ${e.quantity??""}`)},[()=>I(e.item.itemId)?.src??""]),u("error",i,t=>t.preventDefault()),o(t,a),p()}var V=(t,e)=>e.closeDialog(),W=v('<div class="loading svelte-1ttqaeh">請稍候...</div>'),C=v('<div class="container svelte-1ttqaeh"><div class="item-info svelte-1ttqaeh"><img class="item-image svelte-1ttqaeh"/> <div class="item-detail svelte-1ttqaeh"><div class="item-label svelte-1ttqaeh"> <span></span> </div> <div class="item-owned svelte-1ttqaeh"> </div></div> <form class="item-purchase svelte-1ttqaeh"><input class="purchase-quantity-range svelte-1ttqaeh" type="range"/> &times;<input class="purchase-quantity svelte-1ttqaeh" type="number"/> <div class="btn-list svelte-1ttqaeh"><button type="button" class="btn svelte-1ttqaeh">取消</button> <button type="submit" class="btn svelte-1ttqaeh">購買</button></div></form></div> <div class="item-description svelte-1ttqaeh"> </div> <!></div>');function F(t,e){n(e,!0);const a=f(()=>D[E.coin]?.quantity??0),s=f(()=>D[e.item.itemId]?.quantity??0);let i=b(1);const l=f(()=>Math.min(Math.floor(g(a)/e.item.price.amount),99)),v=f(()=>g(l)>=g(i));let k=b(!1);var $=C(),_=c($),w=c(_),S=r(w,2),A=c(S),J=c(A),L=r(J,2),B=r(A,2),H=c(B),F=r(S,2),G=c(F);M(G,"min",1);var O=r(G,2);M(O,"min",1);var P=r(O,2),Q=c(P);Q.__click=[V,e];var R=r(Q,2),T=r(_,2),U=c(T),X=r(T,2),Y=t=>{var e=W();x(3,e,()=>q,()=>({duration:250})),o(t,e)};h(X,t=>{g(k)&&t(Y)}),m(t=>{M(w,"src",t),M(w,"alt",e.item.name),d(J,`${e.item.name??""} `),d(L,` $${e.item.price.amount??""}`),d(H,`已擁有：${g(s)??""} 個`),M(G,"max",g(l)),G.disabled=!g(v),M(O,"max",g(l)),O.disabled=!g(v),R.disabled=!g(v),d(U,e.item.description)},[()=>I(e.item.itemId).src]),u("submit",F,async function(t){t.preventDefault(),g(v)&&(y(k,!0),await j(e.item,g(i)),y(k,!1),await z(N,{props:{item:e.item,quantity:g(i)}}))}),K(G,()=>g(i),t=>y(i,t)),K(O,()=>g(i),t=>y(i,t)),o(t,$),p()}k(["click"]);var G=()=>history.back(),O=(t,e)=>z(F,{props:{item:g(e)}}),P=v('<button class="item svelte-irnz7x"><img class="item-image svelte-irnz7x"/> <p class="label svelte-irnz7x"> </p></button>'),Q=v('<div class="empty-item svelte-irnz7x"><div class="empty-item-img svelte-irnz7x"></div></div>'),R=v('<div class="list-container svelte-irnz7x"><div class="list svelte-irnz7x"><!> <!></div></div>'),T=v('<div class="loading svelte-irnz7x">載入中……</div>'),U=v('<main class="svelte-irnz7x"><header class="svelte-irnz7x"><h1 class="label svelte-irnz7x">菜菜商店</h1> <button class="back svelte-irnz7x"><img alt="back" class="svelte-irnz7x"/></button></header> <!> <footer class="svelte-irnz7x"><span class="currency-amount label svelte-irnz7x"><img class="currency-icon svelte-irnz7x" alt=""/> </span></footer></main>');function X(t,e){n(e,!0);const a=S(),s=f(()=>D[E.coin]?.quantity??0);var i=U(),l=c(i),v=r(c(l),2);v.__click=[G];var h=c(v),b=r(l,2);$(b,()=>a,t=>{var e=T();o(t,e)},(t,e)=>{var a=R(),s=c(a),i=c(s);_(i,17,()=>g(e),w,(t,e)=>{var a=P();a.__click=[O,e];var s=c(a),i=r(s,2),l=c(i);m(t=>{M(s,"src",t),M(s,"alt",g(e).name),d(l,`$${g(e).price.amount??""}`)},[()=>I(g(e).itemId)?.src]),u("error",s,t=>t.preventDefault()),o(t,a)});var l=r(i,2);_(l,17,()=>Array.from({length:Math.max(0,24-A.length)}),w,(t,e)=>{var a=Q();o(t,a)}),o(t,a)});var y=r(b,2),z=c(y),x=c(z),q=r(x);m(t=>{M(h,"src",J.back.src),M(x,"src",t),d(q,` $${g(s)??""}`)},[()=>I(E.coin).src]),o(t,i),p()}k(["click"]);export{X as default};
